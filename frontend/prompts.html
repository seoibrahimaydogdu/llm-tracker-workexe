<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompts - AI Analytics Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4f46e5;
            --secondary-color: #10b981;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            --dark-color: #1f2937;
            --light-color: #f9fafb;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --sidebar-width: 260px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light-color);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar - Same as before */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid var(--border-color);
            padding: 24px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            padding: 0 24px 24px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
        }

        .logo h1 {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 4px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-link:hover,
        .nav-link.active {
            background: #f3f4f6;
            color: var(--primary-color);
        }

        .nav-link.active {
            border-right: 3px solid var(--primary-color);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 24px;
            background: var(--light-color);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            background: white;
            padding: 20px 24px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        .header-left h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .header-left p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background: #4338ca;
        }

        /* Filters */
        .filters-section {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .filters-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: white;
            color: var(--text-primary);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 14px;
        }

        .search-box i {
            color: var(--text-secondary);
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .stat-item.active {
            background: #e0e7ff;
            color: var(--primary-color);
        }

        .stat-item.inactive {
            background: #fef2f2;
            color: var(--danger-color);
        }

        .stat-item.suggested {
            background: #f0fdf4;
            color: var(--success-color);
        }

        .stat-number {
            background: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 700;
        }

        /* Table */
        .table-container {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .prompts-table {
            width: 100%;
            border-collapse: collapse;
        }

        .prompts-table th {
            background: #f8fafc;
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: sticky;
            top: 0;
        }

        .prompts-table td {
            padding: 16px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 14px;
            vertical-align: middle;
        }

        .prompts-table tr:hover {
            background: #f8fafc;
        }

        .prompt-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
        }

        .prompt-checkbox:checked {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .prompt-text {
            max-width: 400px;
            line-height: 1.4;
            color: var(--text-primary);
        }

        .prompt-text.truncate {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-badge.active {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.inactive {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-badge.suggested {
            background: #fef3c7;
            color: #92400e;
        }

        /* AI Model Icons */
        .ai-models {
            display: flex;
            gap: 4px;
        }

        .ai-model-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            color: white;
        }

        .ai-model-icon.chatgpt { background: #10a37f; }
        .ai-model-icon.gemini { background: #4285f4; }
        .ai-model-icon.claude { background: #ff6b35; }
        .ai-model-icon.meta { background: #1877f2; }
        .ai-model-icon.deepseek { background: #8b5cf6; }
        .ai-model-icon.grok { background: #000000; }

        /* Performance Bars */
        .performance-bar {
            width: 60px;
            height: 4px;
            background: #f3f4f6;
            border-radius: 2px;
            overflow: hidden;
        }

        .performance-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.3s;
        }

        .performance-fill.excellent { background: var(--success-color); }
        .performance-fill.good { background: var(--warning-color); }
        .performance-fill.average { background: var(--danger-color); }

        .performance-text {
            font-size: 12px;
            font-weight: 600;
            margin-top: 2px;
        }

        /* Visibility Indicators */
        .visibility-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .visibility-dots {
            display: flex;
            gap: 2px;
        }

        .visibility-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #e5e7eb;
        }

        .visibility-dot.active { background: var(--success-color); }
        .visibility-dot.partial { background: var(--warning-color); }

        .visibility-percentage {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* Tags */
        .tags-container {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .tag {
            background: #f3f4f6;
            color: var(--text-secondary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .tag.website { background: #e0e7ff; color: var(--primary-color); }
        .tag.brand { background: #fef3c7; color: var(--warning-color); }
        .tag.model { background: #f0fdf4; color: var(--success-color); }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                padding: 16px;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <h1><i class="fas fa-chart-line"></i> AI Analytics</h1>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <div class="nav-icon"><i class="fas fa-chart-line"></i></div>
                        Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="prompts.html" class="nav-link active">
                        <div class="nav-icon"><i class="fas fa-comment-dots"></i></div>
                        Prompts
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <div class="nav-icon"><i class="fas fa-globe"></i></div>
                        Sources
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <div class="nav-icon"><i class="fas fa-chart-bar"></i></div>
                        Analytics
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <div class="nav-icon"><i class="fas fa-lightbulb"></i></div>
                        Insights
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1>Prompts</h1>
                    <p>AI model performance analysis and prompt management</p>
                </div>
                <div class="header-actions">
                    <button class="btn">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn">
                        <i class="fas fa-filter"></i> Filter
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-plus"></i> New Prompt
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters-section">
                <div class="filters-header">
                    <h3 class="filters-title">Filters</h3>
                    <button class="btn" onclick="clearFilters()">
                        <i class="fas fa-times"></i> Clear All
                    </button>
                </div>
                
                <div class="filters-grid">
                    <div class="filter-group">
                        <label class="filter-label">All Models</label>
                        <select class="filter-select" id="model-filter">
                            <option value="">All Models</option>
                            <option value="chatgpt">ChatGPT</option>
                            <option value="gemini">Gemini</option>
                            <option value="claude">Claude</option>
                            <option value="meta">Meta Llama</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="grok">Grok</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">All Topics</label>
                        <select class="filter-select" id="topic-filter">
                            <option value="">All Topics</option>
                            <option value="customer-service">Customer Service</option>
                            <option value="whatsapp">WhatsApp</option>
                            <option value="support">Support</option>
                            <option value="automation">Automation</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Status</label>
                        <select class="filter-select" id="status-filter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suggested">Suggested</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Search</label>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Search prompts..." id="search-input">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-item active">
                    <i class="fas fa-check-circle"></i>
                    Active <span class="stat-number">17</span>
                </div>
                <div class="stat-item suggested">
                    <i class="fas fa-lightbulb"></i>
                    Suggested <span class="stat-number">8</span>
                </div>
                <div class="stat-item inactive">
                    <i class="fas fa-pause-circle"></i>
                    Inactive <span class="stat-number">3</span>
                </div>
            </div>

            <!-- Table -->
            <div class="table-container">
                <table class="prompts-table">
                    <thead>
                        <tr>
                            <th style="width: 40px;">
                                <input type="checkbox" class="prompt-checkbox" id="select-all">
                            </th>
                            <th style="width: 50%;">Prompt</th>
                            <th style="width: 100px;">Playlist</th>
                            <th style="width: 100px;">Sentiment</th>
                            <th style="width: 100px;">Visibility</th>
                            <th style="width: 80px;">Ranking</th>
                            <th style="width: 100px;">Topics</th>
                            <th style="width: 80px;">Category</th>
                        </tr>
                    </thead>
                    <tbody id="prompts-tbody">
                        <!-- Prompts will be loaded here -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script>
        // Sample prompts data - bu gerçek API'dan gelecek
        const promptsData = [
            {
                id: 1,
                prompt: "How does the customer support experience differ between various messaging tools?",
                status: 'active',
                aiModels: ['chatgpt', 'gemini'],
                visibility: 85,
                ranking: '3rd',
                sentiment: 'positive',
                topics: ['customer-service', 'support'],
                category: 'Support Tools',
                performance: 85
            },
            {
                id: 2,
                prompt: "How can I streamline customer chats from different countries into one system?",
                status: 'active',
                aiModels: ['chatgpt', 'claude', 'meta'],
                visibility: 78,
                ranking: '5th',
                sentiment: 'neutral',
                topics: ['automation', 'international'],
                category: 'Automation',
                performance: 78
            },
            {
                id: 3,
                prompt: "Is there a AI chatbot for my e-commerce website. What platform should I use?",
                status: 'suggested',
                aiModels: ['gemini', 'deepseek'],
                visibility: 92,
                ranking: '1st',
                sentiment: 'positive',
                topics: ['ecommerce', 'chatbot'],
                category: 'E-commerce',
                performance: 92
            },
            {
                id: 4,
                prompt: "How to track C&AT and agent performance over WhatsApp?",
                status: 'active',
                aiModels: ['chatgpt', 'gemini', 'claude'],
                visibility: 73,
                ranking: '7th',
                sentiment: 'neutral',
                topics: ['whatsapp', 'analytics'],
                category: 'Analytics',
                performance: 73
            },
            {
                id: 5,
                prompt: "What platform helps support agents reply faster using AI?",
                status: 'active',
                aiModels: ['chatgpt', 'claude'],
                visibility: 67,
                ranking: '12th',
                sentiment: 'positive',
                topics: ['ai-support', 'automation'],
                category: 'AI Support',
                performance: 67
            },
            {
                id: 6,
                prompt: "What's the best messaging platform for e-commerce customer service?",
                status: 'suggested',
                aiModels: ['gemini', 'meta'],
                visibility: 88,
                ranking: '2nd',
                sentiment: 'positive',
                topics: ['ecommerce', 'messaging'],
                category: 'E-commerce',
                performance: 88
            },
            {
                id: 7,
                prompt: "How to handle customer support for Shopify store with WhatsApp and Instagram?",
                status: 'active',
                aiModels: ['chatgpt', 'gemini', 'deepseek'],
                visibility: 81,
                ranking: '4th',
                sentiment: 'positive',
                topics: ['shopify', 'whatsapp', 'instagram'],
                category: 'E-commerce',
                performance: 81
            },
            {
                id: 8,
                prompt: "How do I manage conversations across WhatsApp, Instagram, and email in one dashboard?",
                status: 'active',
                aiModels: ['chatgpt', 'claude', 'grok'],
                visibility: 75,
                ranking: '6th',
                sentiment: 'neutral',
                topics: ['omnichannel', 'dashboard'],
                category: 'Communication',
                performance: 75
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Load from API instead of static data
            loadPromptsFromAPI();
            setupEventListeners();
        });

        // Render prompts table
        function renderPrompts(data) {
            const tbody = document.getElementById('prompts-tbody');
            tbody.innerHTML = '';

            data.forEach(prompt => {
                const row = createPromptRow(prompt);
                tbody.appendChild(row);
            });
        }

        // Create prompt row
        function createPromptRow(prompt) {
            const tr = document.createElement('tr');
            
            // API'den gelen data format'ına uygun
            const aiModelsHtml = prompt.ai_models.map(model => {
                return `<div class="ai-model-icon ${model}" title="${getModelName(model)}">${getModelInitial(model)}</div>`;
            }).join('');

            const topicsHtml = prompt.topics.map(topic => {
                return `<span class="tag website">${topic}</span>`;
            }).join('');

            const visibilityDots = Array.from({length: 5}, (_, i) => {
                const dotClass = i < Math.floor(prompt.visibility / 20) ? 'active' : '';
                return `<div class="visibility-dot ${dotClass}"></div>`;
            }).join('');

            const performanceClass = prompt.performance >= 80 ? 'excellent' : 
                                   prompt.performance >= 60 ? 'good' : 'average';

            tr.innerHTML = `
                <td>
                    <input type="checkbox" class="prompt-checkbox" data-id="${prompt.id}">
                </td>
                <td>
                    <div class="prompt-text">${prompt.prompt}</div>
                </td>
                <td>
                    <div class="ai-models">${aiModelsHtml}</div>
                </td>
                <td>
                    <span class="status-badge ${prompt.sentiment}">${prompt.sentiment}</span>
                </td>
                <td>
                    <div class="visibility-indicator">
                        <div class="visibility-dots">${visibilityDots}</div>
                        <span class="visibility-percentage">${prompt.visibility}%</span>
                    </div>
                </td>
                <td>
                    <div class="performance-text">${prompt.ranking}</div>
                    <div class="performance-bar">
                        <div class="performance-fill ${performanceClass}" style="width: ${prompt.performance}%"></div>
                    </div>
                </td>
                <td>
                    <div class="tags-container">${topicsHtml}</div>
                </td>
                <td>
                    <span class="tag brand">${prompt.category}</span>
                </td>
            `;

            return tr;
        }

        // Helper functions
        function getModelName(model) {
            const names = {
                'chatgpt': 'ChatGPT',
                'gemini': 'Gemini',
                'claude': 'Claude',
                'meta': 'Meta Llama',
                'deepseek': 'DeepSeek',
                'grok': 'Grok'
            };
            return names[model] || model;
        }

        function getModelInitial(model) {
            const initials = {
                'chatgpt': 'C',
                'gemini': 'G',
                'claude': 'Cl',
                'meta': 'M',
                'deepseek': 'D',
                'grok': 'X'
            };
            return initials[model] || model.charAt(0).toUpperCase();
        }

        // Event listeners
        function setupEventListeners() {
            // Search functionality
            document.getElementById('search-input').addEventListener('input', handleSearch);
            
            // Filter functionality
            document.getElementById('model-filter').addEventListener('change', handleFilter);
            document.getElementById('topic-filter').addEventListener('change', handleFilter);
            document.getElementById('status-filter').addEventListener('change', handleFilter);
            
            // Select all checkbox
            document.getElementById('select-all').addEventListener('change', handleSelectAll);
        }

        // Search handler
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase();
            const filteredData = promptsData.filter(prompt => 
                prompt.prompt.toLowerCase().includes(searchTerm) ||
                prompt.category.toLowerCase().includes(searchTerm) ||
                prompt.topics.some(topic => topic.toLowerCase().includes(searchTerm))
            );
            renderPrompts(filteredData);
        }

        // Filter handler
        function handleFilter() {
            const modelFilter = document.getElementById('model-filter').value;
            const topicFilter = document.getElementById('topic-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            
            let filteredData = promptsData;
            
            if (modelFilter) {
                filteredData = filteredData.filter(prompt => 
                    prompt.aiModels.includes(modelFilter)
                );
            }
            
            if (topicFilter) {
                filteredData = filteredData.filter(prompt => 
                    prompt.topics.includes(topicFilter)
                );
            }
            
            if (statusFilter) {
                filteredData = filteredData.filter(prompt => 
                    prompt.status === statusFilter
                );
            }
            
            renderPrompts(filteredData);
        }

        // Select all handler
        function handleSelectAll(e) {
            const checkboxes = document.querySelectorAll('.prompt-checkbox[data-id]');
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        }

        // Clear filters
        function clearFilters() {
            document.getElementById('model-filter').value = '';
            document.getElementById('topic-filter').value = '';
            document.getElementById('status-filter').value = '';
            document.getElementById('search-input').value = '';
            renderPrompts(promptsData);
        }

        // Load from API (updated implementation)
        async function loadPromptsFromAPI() {
            try {
                console.log('📡 API\'dan prompts yükleniyor...');
                
                const response = await fetch('http://localhost:8000/get-prompts');
                const result = await response.json();
                
                if (result.status === 'success') {
                    const data = result.data;
                    
                    // Update stats
                    updateStatsBar(data.stats);
                    
                    // Render prompts
                    renderPrompts(data.prompts);
                    
                    console.log(`✅ ${data.prompts.length} prompt yüklendi`);
                } else {
                    console.error('❌ API hatası:', result.message);
                    showError('Prompts yüklenemedi: ' + result.message);
                }
            } catch (error) {
                console.error('❌ Bağlantı hatası:', error);
                showError('API bağlantısı kurulamadı: ' + error.message);
            }
        }

        // Update stats bar with real data
        function updateStatsBar(stats) {
            document.querySelector('.stat-item.active .stat-number').textContent = stats.active_count;
            document.querySelector('.stat-item.suggested .stat-number').textContent = stats.suggested_count;
            document.querySelector('.stat-item.inactive .stat-number').textContent = stats.inactive_count;
        }

        // Show error message
        function showError(message) {
            const container = document.querySelector('.table-container');
            container.innerHTML = `
                <div style="padding: 40px; text-align: center; color: #ef4444;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <h3>Hata Oluştu</h3>
                    <p>${message}</p>
                    <button onclick="loadPromptsFromAPI()" style="margin-top: 16px; padding: 8px 16px; background: #4f46e5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        <i class="fas fa-refresh"></i> Tekrar Dene
                    </button>
                </div>
            `;
        }
    </script>
</body>
</html>